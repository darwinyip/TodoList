<html>
	<head>
		<meta http-equiv="content-type" content="text/html; charset=utf-8" />
		<title>Todo List</title>
	</head>
	<body>
		<h1 id="h1">Todo List</h1>
		<input type="text" id="text">
		<button type="button" onclick=l.appendItem()>Add to list</button>
		<button type="button" onclick="">Save</button>
		<ul id="ul">
		</ul>
		<script>
			class TodoList {

				constructor() {
					this.list = [];
					this.todoCount = 0;
				}

				getList() {
					return this.list;
				}

				updateCount(element) {
					if(element.checked) {
						this.todoCount--;
					}
					else {
						this.todoCount++;
					}
					document.getElementById("h1").textContent = "Todo List (" + this.todoCount + ")";
				}

				deleteItem(item) {
					console.log(item);
					if(!item.childNodes[1].checked) {
						this.todoCount--;
						document.getElementById("h1").textContent = "Todo List (" + this.todoCount + ")";
					}
					item.parentNode.removeChild(item);
				}

				createItem(text) {
					let item = document.createElement("li");
					let textbox = document.createElement("input");
					let check = document.createElement("input");
					let deletebutton = document.createElement("button");

					textbox.setAttribute("type", "text");
					textbox.setAttribute("value", text);

					check.setAttribute("type", "checkbox");
					check.onchange = this.updateCount.bind(this, check);

					deletebutton.innerHTML = "X";
					deletebutton.onclick = this.deleteItem.bind(this, item);

					item.appendChild(textbox);
					item.appendChild(check);
					item.appendChild(deletebutton);
					
					return item;
				}

				appendItem() {
					let form = document.getElementById("text");
					if(form.value) {
						let item = this.createItem(form.value);
						this.list.push(item);
						document.getElementById("ul").append(item);
						this.todoCount++;
						document.getElementById("h1").textContent = "Todo List (" + this.todoCount + ")";
					}
					form.value = "";
				}
			}

			let l = new TodoList();
		</script>
	</body>
</html>